### 线索记录模块修改测试说明

#### 完成的修改

根据《修改.md》文档要求，系统已完成以下修改：

##### 1. 数据库层修改
- ✅ 在 `ViewingRecord` 模型中添加了新字段：
  - `sourcePlatform` - 线索来源平台
  - `customerRoomType` - 客户需求房源
  - `sourcePropertyPrice` - 客户来源房源价格  
  - `followUpPlatform` - 当前跟进平台
  - `customerStatus` - 客户状态
  - `leadViewingStatus` - 带看状态
  - `viewingProperties` - 带看房源
  - `customerFeedback` - 客户反馈

##### 2. 后端API修改
- ✅ 更新了 `CreateViewingRecordDto` 和 `QueryViewingRecordsDto`
- ✅ 添加了新字段的验证规则和枚举类型
- ✅ 实现了业务逻辑：当客户状态为"已约带看"时，验证带看信息
- ✅ 更新了查询和筛选功能以支持新字段

##### 3. 前端界面修改
- ✅ 更新了 TypeScript 类型定义
- ✅ 在创建/编辑表单中添加了新字段
- ✅ 实现了动态显示逻辑：当客户状态为"已约带看"时显示带看信息表单
- ✅ 更新了表格列显示新字段信息
- ✅ 更新了详情页面显示新字段
- ✅ 更新了移动端卡片组件显示新字段

#### 测试验证步骤

##### 1. 创建线索测试
1. 访问线索记录页面
2. 点击"新建线索记录"按钮
3. 填写基础信息：
   - 客户姓名（必填）
   - 联系电话（必填）
   - 线索来源平台（必填）- 选择选项
   - 客户需求房源（必填）- 选择选项
   - 客户来源房源价格（必填）
   - 当前跟进平台（必填）- 选择选项
   - 客户状态（必填）- 选择"接洽中"
4. 保存记录，验证成功创建

##### 2. 状态流转测试
1. 编辑刚创建的线索记录
2. 将客户状态改为"已约带看"
3. 验证带看信息表单区域自动显示
4. 填写带看信息：
   - 带看状态（必填）
   - 带看日期（必填）
   - 带看房源（可选）
   - 客户反馈（可选）
5. 保存记录，验证状态流转和数据保存

##### 3. 界面显示测试
1. 在列表页面查看：
   - 新字段在表格中正确显示
   - 客户状态用颜色标签区分
   - 平台信息正确显示
   - 价格信息格式化显示
2. 在详情页面查看：
   - 基础信息部分显示新字段
   - 带看信息部分（仅在客户状态为"已约带看"时显示）
   - 所有字段正确显示和格式化
3. 在移动端查看：
   - 卡片组件正确显示新字段
   - 标签颜色和信息布局合理

##### 4. 筛选功能测试
1. 使用筛选器：
   - 按线索来源平台筛选
   - 按客户需求房源筛选
   - 按客户状态筛选
   - 按当前跟进平台筛选
2. 验证筛选结果正确

##### 5. 验证规则测试
1. 尝试创建线索但不填写必填字段，验证错误提示
2. 将客户状态改为"已约带看"但不填写带看状态，验证错误提示
3. 输入无效的价格格式，验证验证规则

#### 当前服务状态
- 后端服务运行在端口 3001
- 前端服务运行在端口 5173 (开发) 和 4173 (预览)

#### 注意事项
1. 所有必填字段验证已在前端和后端同时实现
2. 动态表单显示逻辑基于客户状态变化
3. 新字段向下兼容，现有数据不会受影响
4. 移动端和桌面端界面都已更新适配 